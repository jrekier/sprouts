(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43826,       1137]
NotebookOptionsPosition[     41289,       1087]
NotebookOutlinePosition[     41681,       1103]
CellTagsIndexPosition[     41638,       1100]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.737913811269846*^9, 3.7379138129915323`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"f4e079fa-f962-4e29-9b2d-d2d786230e74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mode", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.918921551903813*^9, 3.918921587049843*^9}, {
  3.918923841217482*^9, 3.9189239158478127`*^9}, {3.918926183035284*^9, 
  3.918926183264311*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"9eb05443-3915-4f8d-bdef-9faf1cb05f72"],

Cell[CellGroupData[{

Cell["Load solution", "Subsubsection",
 CellChangeTimes->{{3.732517482899136*^9, 3.7325174999152193`*^9}, {
  3.736873914894808*^9, 3.736873915831726*^9}, {3.7379138047427883`*^9, 
  3.737913806421977*^9}, {3.91883999477559*^9, 3.9188399954051323`*^9}, {
  3.9189199486003323`*^9, 3.91891995063596*^9}, {3.918920548196268*^9, 
  3.918920548768958*^9}},ExpressionUUID->"ce64a92a-505b-48dd-a266-\
05a317c60755"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{"\"\<spectral`\>\"", ",", "\"\<../spectral.m\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.918917904884705*^9, 3.9189179688855247`*^9}, {
  3.918919618101427*^9, 3.9189196189585648`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"10ed5c7e-c673-4128-9fc0-4a367e3ec963"],

Cell[BoxData["\<\"/Users/rekierj/sprouts/multilayer\"\>"], "Output",
 CellChangeTimes->{{3.918917953399225*^9, 3.9189179844066877`*^9}, 
   3.918918027882503*^9, 3.918918746767776*^9, 3.918919524164859*^9, 
   3.9189196207320433`*^9, 3.91892055275333*^9, {3.918921359750976*^9, 
   3.918921381407611*^9}, {3.918921502436195*^9, 3.918921516402513*^9}, {
   3.918921562228876*^9, 3.918921590687847*^9}, 3.918923600949213*^9, 
   3.918923770034988*^9, {3.918923825884623*^9, 3.918923918157008*^9}, 
   3.918926186609758*^9, 3.918926311023768*^9, 3.918927145172882*^9, 
   3.918927886177127*^9, 3.918935437886512*^9, {3.920131879384832*^9, 
   3.9201318850162086`*^9}, 3.920131918997555*^9, 3.920133069316774*^9, 
   3.9201341666098833`*^9, 3.920134999091915*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"4684ab34-f06e-4eb7-9aa8-953c74a56043"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vector", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{
     RowBox[{"Sprouts`Amat", "[", "0", "]"}], ",", "Sprouts`bvec"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.920130780799796*^9, 3.920130805082486*^9}, {
  3.920130857870181*^9, 3.9201308586722918`*^9}, {3.9201318658077374`*^9, 
  3.920131874155105*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"18a293ff-8251-4ba2-917c-dab84996f603"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vector", "=", 
   RowBox[{"feigv", "[", 
    RowBox[{"[", "mode", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"feig", "[", 
    RowBox[{"[", "mode", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.918909771012339*^9, 3.918909780968689*^9}, {
  3.918917646890883*^9, 3.9189176474641523`*^9}, {3.918918587534124*^9, 
  3.918918587884795*^9}, {3.9189187948544827`*^9, 3.9189187961982327`*^9}, {
  3.9189191641737413`*^9, 3.9189191643639383`*^9}, {3.918920051333797*^9, 
  3.9189200575701227`*^9}, {3.918921377522457*^9, 3.918921379384691*^9}, {
  3.918921539705306*^9, 3.918921548268689*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"eb155393-33c7-4b10-955b-cca4bde103ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sprouts`nr", "=", 
   RowBox[{"First", "@", "Sprouts`n"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "sollayer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Sprouts`nr", "*", 
    RowBox[{"Length", "/@", "Sprouts`layout"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"True", ",", 
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/=", "2"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sublists", "=", 
   RowBox[{"TakeList", "[", 
    RowBox[{"vector", ",", "list"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sollayer", "[", 
        RowBox[{"First", "@", "#2"}], "]"}], "=", "#1"}], ")"}], "&"}], ",", 
    "sublists"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.91884059719263*^9, 3.918840611295806*^9}, {
   3.918840656653871*^9, 3.918840915163006*^9}, {3.918841139758984*^9, 
   3.9188411399374247`*^9}, 3.918841951669037*^9, {3.918909344583651*^9, 
   3.9189093450539713`*^9}, {3.918909733445418*^9, 3.9189098024597683`*^9}, {
   3.9189138442569036`*^9, 3.9189138533543463`*^9}, {3.9189176604417*^9, 
   3.918917675877849*^9}, {3.920131949931089*^9, 3.9201319544839077`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"96303f41-a11f-4525-8093-8a7db8a4f4fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Sprouts`layout", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"0.", "+", 
                RowBox[{"0.", "\[ImaginaryI]"}]}]}], "]"}], "&"}], "/@", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"sollayer", "[", "i", "]"}], ",", 
              RowBox[{"Sprouts`nr", "/", "2"}]}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Sprouts`layout", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"sollayer", "[", "i", "]"}], ",", "Sprouts`nr"}], 
            "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "Sprouts`layout", "]"}]}], "}"}]}], "]"}], "//",
      "Join"}], "//", "Association"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outnull", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", "#", ")"}], "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "Sprouts`nr"}], "]"}]}], "&"}], ",", 
      RowBox[{
       RowBox[{"Keys", "[", "out", "]"}], "/.", 
       RowBox[{
        RowBox[{"f_", "[", 
         RowBox[{"\[ScriptL]_", ",", "\[ScriptM]_"}], "]"}], "\[Rule]", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"\[ScriptL]", "-", "1"}], ",", "\[ScriptM]"}], "]"}]}]}]}], 
     "]"}], "~", "Join", "~", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", "#", ")"}], "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "Sprouts`nr"}], "]"}]}], "&"}], ",", 
      RowBox[{
       RowBox[{"Keys", "[", "out", "]"}], "/.", 
       RowBox[{
        RowBox[{"f_", "[", 
         RowBox[{"\[ScriptL]_", ",", "\[ScriptM]_"}], "]"}], "\[Rule]", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"\[ScriptL]", "+", "1"}], ",", "\[ScriptM]"}], "]"}]}]}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"out", ",", "outnull"}], "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.918912135926216*^9, 3.918912139351303*^9}, {
   3.918912269043069*^9, 3.918912329697927*^9}, {3.918912632419528*^9, 
   3.918912691564024*^9}, {3.918912748194312*^9, 3.9189127625757227`*^9}, 
   3.918912874217477*^9, {3.9189129120249557`*^9, 3.918912965471374*^9}, {
   3.918913073042131*^9, 3.918913083075333*^9}, {3.9189137178887873`*^9, 
   3.918913772595138*^9}, {3.918913860261058*^9, 3.9189138628165483`*^9}, 
   3.9201321788758297`*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"d533a8fa-ee0b-4b9c-9cb6-4cc3abeca8f4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"NChebevalC", ",", "xk", ",", "rk"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NChebevalC", "[", "c_", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"NChebeval", "[", 
     RowBox[{"N", "[", 
      RowBox[{"Re", "[", "c", "]"}], "]"}], "]"}], "[", "x", "]"}], "+", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{
     RowBox[{"NChebeval", "[", 
      RowBox[{"N", "[", 
       RowBox[{"Im", "[", "c", "]"}], "]"}], "]"}], "[", "x", 
     "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"xk", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "Sprouts`nr"}], "]"}]}], "-", "1"}], ")"}], 
         "\[Pi]"}], 
        RowBox[{"2", "Sprouts`nr"}]], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervals", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rk", "[", "layer", "]"}], "=", 
      RowBox[{
       RowBox[{"Sprouts`rfu", "[", "layer", "]"}], "[", "xk", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"intervals", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"rk", "[", "layer", "]"}], "]"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"layer", ",", "1", ",", 
      RowBox[{"Length", "[", "Sprouts`layout", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.745299547397407*^9, 3.745299548622808*^9}, {
   3.74531685786959*^9, 3.745316895939427*^9}, 3.831804242428125*^9, {
   3.895910155588181*^9, 3.895910157072774*^9}, 3.915124971517597*^9, {
   3.915125042632554*^9, 3.915125042923518*^9}, 3.915125080694763*^9, 
   3.9151253147778673`*^9, {3.918913993353313*^9, 3.9189140517417717`*^9}, {
   3.9189146763160257`*^9, 3.918914682223935*^9}, {3.918918939388221*^9, 
   3.918919019412656*^9}, {3.9189191055382357`*^9, 3.918919107460531*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"1e01e705-dc31-4f69-8621-12bcced9edba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot solution", "Subsubsection",
 CellChangeTimes->{{3.732517482899136*^9, 3.7325174999152193`*^9}, {
  3.736873914894808*^9, 3.736873915831726*^9}, {3.7379138047427883`*^9, 
  3.737913806421977*^9}, {3.91883999477559*^9, 3.9188399954051323`*^9}, {
  3.9189199486003323`*^9, 3.918919962985898*^9}, {3.918921360989251*^9, 
  3.9189213618787746`*^9}, {3.918923775469809*^9, 
  3.9189237759323997`*^9}},ExpressionUUID->"110b704c-8950-4d1f-b6fc-\
929a25354e1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "chosen", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "=", "2"}], ",", 
       RowBox[{"\[ScriptM]", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NChebevalC", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]p", "[", 
            RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", "out"}], 
          "]"}], "[", "xk", "]"}], "//", "Chop"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotp", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Sequence", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"rk", "[", "layer", "]"}], ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"data", "[", "layer", "]"}], "]"}]}], "}"}], 
                "\[Transpose]"}], "}"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", "None"}]}], 
             RowBox[{"(*", "Automatic", "*)"}], "]"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
             RowBox[{"Most", "@", "intervals"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<|\[Delta]p|\>\""}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz00ow2EcwPFRCgsHoby0NDRGsmYjs/rntaRMWqOw5CWnHRbJamZMtGFe
0tQu22HWZszrvMzMKGTLmrcmRDlo81dyWXLw/J7Dt8/5m90lae6JplAoWSiQ
z8qlaWNI4i2wTAeJDA4bDMnE2EkjW2OLJYlgR3AavNk4t5oLSEIe78OGxgQU
C3KiRoY9LEuR3iFfGAvYlnpz3BPyV32L1Yn2+/OZJFFBVUjBmcxK5ygy4hlx
g8OSTq8S2aAq8oHzgo9P0KH7wn4LxYSTRRIXjOdqMCqy1AiaAmvYoffgOLje
xFWBL8WDUyDf0KYGlV9eLRgxXRrAQo1tHTQK6+xgYhF9F/Tv/OyD2w/schcy
fKPngenJmw4wMHeyBy4SK07QsneHPRi4PgU5uY9YRdV9zjGyO++sBLR69a3g
r5bbDgqptFs38vVoFuv6y5Z7kN4wEyuSzyYklaLfLTvWv5rKA+W9V7Xg04Oj
DxxK82D/AY5K7T4=
  "],
 CellLabel->"In[73]:=",ExpressionUUID->"c538abce-7d0e-45a8-bc04-1986df13728d"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJw1k21I01EUxv9Jr2azwhgZmmKQWZmtRlnmI9EbfihfQv1QmkUKQklKSC/g
0JDAT5FaMRsi+zDKYipiCXHADGJZqWRWOlM3y83NfzjUqKmtOufC5XLgcu95
nud3os8XZ1wMUhRlb2D/Pf+vH4gsS10xuaiiau3D+JnfKjpMtz39cyrO3HW8
NA+qcGtdIbntgdq5q2aLUUVG1smakn0qfpqX2toOqHAO6ma016dQou/te94x
hZx7dktqhRcDixX+5k2B+thClC/TA692bDo514tYY73y0efGpR2HIqIqPWiY
CRkyFLqQZFtp11VP4nB149s9bd+xKl3/9EqZG+boxsTXjnFM34mI851wYSQn
a2vtLweGXq2ZmlAmUBTqMqUvGUP3wfICU8M3hP/T8xWelhRD2bZxXHjf2aOb
H0Rwkz1FrXegNGmCHgd/gluxHq/zj8L7KM14dP8HOBsjE9eljqB54FTp5doe
KMNHtsdr7JhdNttkybeh03XTP1z0Gbbi9vDTCV0YqsvuGX3Sj7CqfB3lvYBG
E1Y5/6UXsQsFviBvK4o298VEet7A2notevdZC65mWgpXL+9CwsZbeZrQB1C1
/vIb2mcwdGffT46pwLmcuZ3rNzRAeWet1MelSU1S832S+/weyXv8H8l/3A9J
P9wvSb+sh0QP6yXRy36Q+MF+kfjFfpL4yX6T+M15kOTBeZHkxXmS5Ml5k+TN
PJDwwLyQ8MI8kfDEvJHwxjyS8Mi8kvDKPJPwzLyT8M7zQDIPPC8k8/IH3hay
Dw==
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], {}},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"|\[Delta]p|\"", TraditionalForm],
  PlotRange->{{0, 1}, Automatic},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.920132637356477*^9, 3.920132666892377*^9}, 
   3.920133075338975*^9, 3.920134172753346*^9, 3.9201350062944508`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"791010dd-a7bd-4b42-bd5c-bb4c53ccfdf1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "chosen", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "=", "2"}], ",", 
       RowBox[{"\[ScriptM]", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{"\[ScriptL]", 
         RowBox[{"(", 
          RowBox[{"\[ScriptL]", "+", "1"}], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"NChebevalC", "[", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", "out"}],
             "]"}], "[", "xk", "]"}], 
          RowBox[{"rk", "[", "1", "]"}]]}], "//", "Chop"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotUr", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Sequence", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"rk", "[", "layer", "]"}], ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"data", "[", "layer", "]"}], "]"}]}], "}"}], 
                "\[Transpose]"}], "}"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", "None"}]}], " ", 
             RowBox[{"(*", "Automatic", "*)"}], "]"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
             RowBox[{"Most", "@", "intervals"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<|Ur|\>\""}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.918915044270936*^9, 3.918915088562366*^9}, {
   3.9189151606423283`*^9, 3.918915175036901*^9}, {3.91891808249545*^9, 
   3.918918082732654*^9}, {3.918918122149145*^9, 3.918918125842515*^9}, {
   3.9189187733711777`*^9, 3.91891878402756*^9}, {3.918919121317068*^9, 
   3.918919147032992*^9}, {3.918919334010491*^9, 3.918919334337068*^9}, {
   3.918920090106221*^9, 3.918920096413941*^9}, {3.918920258224594*^9, 
   3.918920258565926*^9}, {3.91892040732104*^9, 3.918920420984681*^9}, {
   3.918923410447299*^9, 3.918923412733472*^9}, 3.918926827386904*^9, {
   3.920132675497805*^9, 3.920132762183096*^9}, {3.920132921853057*^9, 
   3.9201329222375717`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"f790ac80-91ad-4b03-ba69-8173f23c9c32"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxNk0kohVEUx78kGV8IbyFTbExPiWQ8FoqsDAsWSAqlZCgsKCI2bEQ2hiQL
C4RS2JwybFCmZHwvc4bnfc8U8WTo+x/56uvXrdu95/zP7waVVOWU2imKEvPz
/1L7rCTscB80vHyo1A4W9JwvjR7940VUb0i/SoXg26j96myCSu9gbezW9vyC
herBva9W27SvhfbBe/3ZY0rRPVnByohkv8A2M1WDSauOxujOO0oBnbJjJ2sa
bkkHPnb7hT1l3NALeLziZrlWrskEric2lw0NX9EGaJ5JbWkIvSQr6DxuTFUH
zskVvFWm0vtsp2QGL0b84z0yT+gKVExp4QadkezAxZsmm6ni4I/HfXmbpxO7
tAPqdF5tn4db9OGmsSJgO9jfvEZxYF3uWLmLwzI952hU9bbmRv0cdfloLM5/
jfT0HqaHLI1Ys6yxn2U/zmM5D/ex3Id6WOpBvSz1og+WftAvS7/IgyUP5MWS
F/JkyRN5s+SNebDMA/NimRfmyTJPzJtl3vCBxQf4wuILfGLxCb6x+AYfWXyE
ryy+wmcWn+E5i+94DyzvAe+E5b18Awvassc=
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], {}},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"|Ur|\"", TraditionalForm],
  PlotRange->{{0, 1}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.920132743737615*^9, 3.920132762587509*^9}, 
   3.920133079536386*^9, 3.920134175178512*^9, 3.9201350160409403`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"fea5bbe9-42fc-4735-be93-94e4f4e9f421"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "chosen", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "=", "2"}], ",", 
       RowBox[{"\[ScriptM]", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"\[ScriptL]", 
            RowBox[{"(", 
             RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"NChebevalC", "[", 
             RowBox[{"DCheb", "[", 
              RowBox[{
               RowBox[{"P", "[", 
                RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
               "out"}], "]"}], "]"}], "[", "xk", "]"}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"NChebevalC", "[", 
              RowBox[{
               RowBox[{"P", "[", 
                RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
               "out"}], "]"}], "[", "xk", "]"}], 
            RowBox[{"rk", "[", "1", "]"}]]}], ")"}]}], "//", "Chop"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotUcon", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Sequence", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"rk", "[", "layer", "]"}], ",", 
                  RowBox[{"Re", "[", 
                   RowBox[{"data", "[", "layer", "]"}], "]"}]}], "}"}], 
                "\[Transpose]"}], "}"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", "None"}]}], 
             RowBox[{"(*", "Automatic", "*)"}], "]"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
             RowBox[{"Most", "@", "intervals"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<|Ucon|\>\""}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.918919686933599*^9, 3.9189196870436983`*^9}, {
  3.9189197265189877`*^9, 3.918919760971724*^9}, {3.9189202685441713`*^9, 
  3.918920313653282*^9}, {3.9189203560060873`*^9, 3.918920375837805*^9}, {
  3.91892041418764*^9, 3.9189204179536858`*^9}, {3.918923433361459*^9, 
  3.918923437771783*^9}, {3.918926580665576*^9, 3.918926608550914*^9}, {
  3.9189266624732513`*^9, 3.91892667485816*^9}, {3.918926817794527*^9, 
  3.918926822225173*^9}, {3.920132776688504*^9, 3.9201328309302464`*^9}, {
  3.920132916111384*^9, 3.920132919339243*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"d5e58875-f3e7-4487-a6b5-31036ea4cadf"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJw1k2tI02EUxpddTCW7mQal5hLCLio6g7Q8CoNE6oON0g+RIrRAsCshXUDL
8EsYSGKGa4oYGqQ0USkhntIVahFNurk2Uzd1F/VfipU5M6OnF15eDhzOe87z
/E5U/pkjJ/1UKpVm6f59/52vcudQjutyh1fK1t2LnZ1X5Ht2beevVq8cv+3o
bvisSFZdaM3vqqXYGVcZXaNIWXNgvTrXKz8bVvS1JyuyrG82tTbIK+eTLP1P
OqdkZXmXpcfgkY+L132mLVNyWF1+dO1Gj0yGjUynnpiUxUslysJptxTuPhC+
rXRCjC3p+ckml+zvW21PuOmV4aYi/Q3ruARkJbWcK/KILXGzu807JtMV4Ttn
Mtzir0mNfzo6KrYXa6ZcKpfUFurH7/c65XVKsd5YNybxUQEht6odMtGaVlIU
Myr+jcaZB7oRCXxoT1MMDsn105jTfUPiUT06WOUbFtPWym95O76Isz5i3/rM
IQmtN7Sb99pENajdFRtsF11ipKYxZkC63Fd9gwUD0n1Nezd8+QexVWW/HW5+
L4EpZ58de9kvwcEhpQtWi2h75+fiJt9IQWT/9oiJV+J8V1l9IbZHLuqaTgWt
MkuMusuVkf1clDBf8ZWwxxIZ9ykzwd4meTk/9mzYVCcL0RVjc9aa/zEYg/lg
PlgPrAf+B/4H9gP2A/YL9gvOA84DzgvOC+oB6gHqBeoF6gnqCeoN6g36AfoB
+gX6BfoJ+gn6DfoN8gDyAPIC8gLyBPIE8gbyBvII8gjyCvIK8gzyDPIO8g7u
A7gP4L6A+4I/2OrCtw==
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], {}},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"|Ucon|\"", TraditionalForm],
  PlotRange->{{0, 1}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9201328318649883`*^9, 3.92013308146059*^9, 
  3.920134181690082*^9, 3.920135020714148*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"283798d2-9041-4ae5-8299-f38a6ae9bf4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "chosen", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "=", "3"}], ",", 
       RowBox[{"\[ScriptM]", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", "1", "]"}], "=", 
        RowBox[{
         RowBox[{
          SqrtBox[
           FractionBox[
            RowBox[{"\[ScriptL]", 
             RowBox[{"(", 
              RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
          FractionBox[
           RowBox[{
            RowBox[{"NChebevalC", "[", 
             RowBox[{
              RowBox[{"c1f", "[", 
               RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
              "out"}], "]"}], "[", "xk", "]"}], 
           RowBox[{"rk", "[", "1", "]"}]]}], "//", "Chop"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"\[ScriptL]", 
            RowBox[{"(", 
             RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            RowBox[{"NChebevalC", "[", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
              "out"}], "]"}], "[", "xk", "]"}]}], ")"}]}], "//", "Chop"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"data", "[", "3", "]"}], "=", 
         RowBox[{
          RowBox[{
           SqrtBox[
            FractionBox[
             RowBox[{"\[ScriptL]", 
              RowBox[{"(", 
               RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              RowBox[{"NChebevalC", "[", 
               RowBox[{
                RowBox[{"c3f", "[", 
                 RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
                "out"}], "]"}], "[", "xk", "]"}], 
             RowBox[{"rk", "[", "3", "]"}]], ")"}]}], "//", "Chop"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"plotUtor", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Sequence", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"rk", "[", "layer", "]"}], ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"data", "[", "layer", "]"}], "]"}]}], "}"}], 
                "\[Transpose]"}], "}"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", "None"}]}], 
             RowBox[{"(*", "Automatic", "*)"}], "]"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
             RowBox[{"Most", "@", "intervals"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<|Utor|\>\""}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.920132847437611*^9, 3.920132904049717*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"876b647a-5f57-461d-aae7-ba5eda7c249d"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQDQEf7GGsNoG5el9/v4fzYyY/PrzkNhL/if4UldkI
/o8lLKe2WiH4RaYXL+3c9Q7Ov/6/6c9GaQT/rfijT3Zxb+H8XB1bWYXmN3C+
zSmOu0bdr+F8zkDTdYXlr+D8TxNltT57vITz7xzlffeC4QWcf8a6Pm3egmdw
/ptNDg3lmk/hfK41dx3ez3kM579i2OA+7c9DOP/JIjlLQa8HcD7DPRdtPb67
cP6hlzV/7mXdRNg/LfzCw7VX4Xw+PpHmv7cuwvlZ8peU5d6chvNLg1ekc7Md
gfPfi/+prxbfAecnRHzXFRJdgM7fj6Z+P5p5cD7UPjgf6h44H+peOB/qHzgf
6l84HxoecD40vOB8aHjC+dDwhvOh8YGwHxJfcD40PuF8aHzD+dD0AOdD0wuc
D01PcD40vcH50PQI50PTK5wPTc8IPiS9w/nQ/IAIHzD4AOcDAEsp31I=
      
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], {}},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"|Utor|\"", TraditionalForm],
  PlotRange->{{0, 1}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.920132866744267*^9, 3.920132904493382*^9}, 
   3.920133084757653*^9, 3.92013418375163*^9, 3.920135030736484*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"aa2e5522-2f3c-4390-bdd0-db02216f9e4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "chosen", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptL]", "=", "2"}], ",", 
       RowBox[{"\[ScriptM]", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", "1", "]"}], "=", 
        RowBox[{
         RowBox[{
          SqrtBox[
           FractionBox[
            RowBox[{"\[ScriptL]", 
             RowBox[{"(", 
              RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
          FractionBox[
           RowBox[{
            RowBox[{"NChebevalC", "[", 
             RowBox[{
              RowBox[{"c1f", "[", 
               RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
              "out"}], "]"}], "[", "xk", "]"}], 
           RowBox[{"rk", "[", "1", "]"}]]}], "//", "Chop"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"\[ScriptL]", 
            RowBox[{"(", 
             RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            RowBox[{"NChebevalC", "[", 
             RowBox[{
              RowBox[{"G", "[", 
               RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
              "out"}], "]"}], "[", "xk", "]"}]}], ")"}]}], "//", "Chop"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"data", "[", "3", "]"}], "=", 
         RowBox[{
          RowBox[{
           SqrtBox[
            FractionBox[
             RowBox[{"\[ScriptL]", 
              RowBox[{"(", 
               RowBox[{"\[ScriptL]", "+", "1"}], ")"}]}], "2"]], 
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              RowBox[{"NChebevalC", "[", 
               RowBox[{
                RowBox[{"c3f", "[", 
                 RowBox[{"\[ScriptL]", ",", "\[ScriptM]"}], "]"}], "/.", 
                "out"}], "]"}], "[", "xk", "]"}], 
             RowBox[{"rk", "[", "3", "]"}]], ")"}]}], "//", "Chop"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"plotUtor", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Sequence", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"rk", "[", "layer", "]"}], ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"data", "[", "layer", "]"}], "]"}]}], "}"}], 
                "\[Transpose]"}], "}"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", "None"}]}], 
             RowBox[{"(*", "Automatic", "*)"}], "]"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
             RowBox[{"Most", "@", "intervals"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<|Btor|\>\""}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9201350397537613`*^9, 3.920135068758667*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"3c0f8320-05ac-47e3-b4e9-f8019c60131a"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQDQEf7GGsNoG5el9/v4fzYyY/PrzkNhL/if4UldkI
/o8lLKe2WiH4RaYXL+3c9Q7Ov/6/6c9GaQT/rfijT3Zxb+H8XB1bWYXmN3C+
zSmOu0bdr+F8zkDTdYXlr+D8TxNltT57vITz7xzlffeC4QWcf8a6Pm3egmdw
/ptNDg3lmk/hfK41dx3ez3kM579i2OA+7c9DOP/JIjlLQa8HcD7DPRdtPb67
cP6hlzV/7mXdRNg/LfzCw7VX4Xw+PpHmv7cuwvlZ8peU5d6chvNLg1ekc7Md
gfPfi/+prxbfAecnRHzXFRJdgM7fj6Z+P5p5cD7UPjgf6h44H+peOB/qHzgf
6l84HxoecD40vOB8aHjC+dDwhvOh8YGwHxJfcD40PuF8aHzD+dD0AOdD0wuc
D01PcD40vcH50PQI50PTK5wPTc8IPiS9w/nQ/IAIHzD4AOcDAEsp31I=
      
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], {}},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"|Btor|\"", TraditionalForm],
  PlotRange->{{0, 1}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.9201350422261353`*^9, 3.9201350689217463`*^9}},
 CellLabel->"Out[90]=",ExpressionUUID->"61efac5a-7471-49eb-9fc1-2fc49d6509e2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1368, 988},
WindowMargins->{{1, Automatic}, {38, Automatic}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cffe3cc3-b330-4536-8964-d1000cf30490"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 3, 30, "Input",ExpressionUUID->"f4e079fa-f962-4e29-9b2d-d2d786230e74"],
Cell[760, 25, 319, 7, 30, "Input",ExpressionUUID->"9eb05443-3915-4f8d-bdef-9faf1cb05f72"],
Cell[CellGroupData[{
Cell[1104, 36, 409, 6, 45, "Subsubsection",ExpressionUUID->"ce64a92a-505b-48dd-a266-05a317c60755"],
Cell[CellGroupData[{
Cell[1538, 46, 444, 9, 52, "Input",ExpressionUUID->"10ed5c7e-c673-4128-9fc0-4a367e3ec963"],
Cell[1985, 57, 838, 11, 34, "Output",ExpressionUUID->"4684ab34-f06e-4eb7-9aa8-953c74a56043"]
}, Open  ]],
Cell[2838, 71, 439, 10, 30, "Input",ExpressionUUID->"18a293ff-8251-4ba2-917c-dab84996f603"],
Cell[3280, 83, 763, 16, 52, "Input",ExpressionUUID->"eb155393-33c7-4b10-955b-cca4bde103ff"],
Cell[4046, 101, 1453, 36, 136, "Input",ExpressionUUID->"96303f41-a11f-4525-8093-8a7db8a4f4fa"],
Cell[5502, 139, 3304, 85, 199, "Input",ExpressionUUID->"d533a8fa-ee0b-4b9c-9cb6-4cc3abeca8f4"],
Cell[8809, 226, 2390, 65, 201, "Input",ExpressionUUID->"1e01e705-dc31-4f69-8621-12bcced9edba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11236, 296, 463, 7, 45, "Subsubsection",ExpressionUUID->"110b704c-8950-4d1f-b6fc-929a25354e1f"],
Cell[CellGroupData[{
Cell[11724, 307, 3154, 79, 178, "Input",ExpressionUUID->"c538abce-7d0e-45a8-bc04-1986df13728d"],
Cell[14881, 388, 2261, 54, 262, "Output",ExpressionUUID->"791010dd-a7bd-4b42-bd5c-bb4c53ccfdf1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17179, 447, 3448, 83, 213, "Input",ExpressionUUID->"f790ac80-91ad-4b03-ba69-8173f23c9c32"],
Cell[20630, 532, 2036, 50, 260, "Output",ExpressionUUID->"fea5bbe9-42fc-4735-be93-94e4f4e9f421"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22703, 587, 3758, 93, 221, "Input",ExpressionUUID->"d5e58875-f3e7-4487-a6b5-31036ea4cadf"],
Cell[26464, 682, 2240, 54, 245, "Output",ExpressionUUID->"283798d2-9041-4ae5-8299-f38a6ae9bf4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28741, 741, 4330, 118, 290, "Input",ExpressionUUID->"876b647a-5f57-461d-aae7-ba5eda7c249d"],
Cell[33074, 861, 1940, 49, 245, "Output",ExpressionUUID->"aa2e5522-2f3c-4390-bdd0-db02216f9e4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35051, 915, 4332, 118, 290, "Input",ExpressionUUID->"3c0f8320-05ac-47e3-b4e9-f8019c60131a"],
Cell[39386, 1035, 1875, 48, 245, "Output",ExpressionUUID->"61efac5a-7471-49eb-9fc1-2fc49d6509e2"]
}, Open  ]]
}, Open  ]]
}
]
*)

